<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Business</title>
    <link rel="stylesheet" href="styles.css">
    <!-- <script src="https://aframe.io/releases/0.7.0/aframe.min.js"></script> -->

    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    <script>
        AFRAME.registerComponent('rotation-reader', {
            tick: function () {
                this.el.object3D.rotation.x = -.4;
                var flockAudio = document.querySelector("#flock-audio");

                // `this.el` is the element.
                // `object3D` is the three.js object.

                // `rotation` is a three.js Euler using radians. `quaternion` also available.

                // console.log(this.el.object3D.rotation.y)
                // if (this.el.object3D.rotation.y < -1.58) {
                //     this.el.object3D.rotation.y = -1.58;
                // } if (this.el.object3D.rotation.y > 1.58) {
                //     this.el.object3D.rotation.y = 1.58;
                // }
                // `position` is a three.js Vector3.
                // console.log(this.el.object3D.position);
                // console.log(-this.el.object3D.rotation.y)
                if (-this.el.object3D.rotation.y < 0) {
                    flockAudio.volume = 0
                } else if (-this.el.object3D.rotation.y > 1) {
                    flockAudio.volume = .5
                } else {
                    flockAudio.volume = (-this.el.object3D.rotation.y) / 2;
                }
                // console.log(flockAudio)
                // console.log(flockAudio.volume)

            }
        });

    </script>
</head>

<body>

    <div class="container">
        <audio id="flock-audio" src="assets/flock.mp3" autoplay loop></audio>
        <audio id="sea-audio" src="assets/sea.mp3" autoplay loop></audio>
        <a-scene>
            <!-- ASSETS -->
            <a-asset-item id="seagull" src="assets/scene.gltf"></a-asset-item>
            <a-asset-item id="sea-normals" src="assets/seaNormals.png"></a-asset-item>

            <!-- CAMERA RIG -->
            <a-entity id="rig" position="0 4.5 0" rotation="0 0 0">
                <a-camera id="camera" position="0 0 0" rotation="10 0 0" far="1000" fov="70" rotation-reader look-controls>

                </a-camera>
            </a-entity>

            <!-- LIGHTS -->
            <a-entity light="type: spot; intensity: .4; penumbra: 0.5;" animation="property: position; from: -10 0 1; to: 10 0 1; loop: true; dir: alternate; dur: 6000; easing: linear;">
            </a-entity>
            <a-entity light="type: ambient; intensity: 2.3">
            </a-entity>

            <!-- SKY -->
            <a-curvedimage src="assets/sky.png" position="0 20 1" scale="20 40 20" material="" geometry="thetaLength: 360">
            </a-curvedimage>

            <!-- SEAGULLS -->
            <a-entity animation="property: position; to: 0 -0.5 0; dir: alternate; loop: true; easing: easeInOutQuad; dur: 2000">
                <a-entity animation="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 30000">
                    <a-entity position="0 5 -5" scale="0.1 0.1 0.1">
                        <a-entity gltf-model="assets/scene.gltf" position="0.75285 -2.10546 0.84533" scale="0.1 0.1 0.1" animation-mixer="clip: *;">
                            <!-- sound="src: url(assets/flock.mp3); loop: true; autoplay: true" -->
                        </a-entity>
                    </a-entity>
                </a-entity>
            </a-entity>

            <a-entity animation="property: position; to: 0 -0.5 0; dir: alternate; loop: true; easing: easeInOutQuad; dur: 3000">
                <a-entity animation="property: rotation; to: 0 360 0; loop: true; easing: linear; dur: 28000">
                    <a-entity position="1 5 -5" scale="0.1 0.1 0.1">
                        <a-entity gltf-model="assets/scene.gltf" position="0.75285 -2.10546 0.84533" scale="0.1 0.1 0.1" animation-mixer="clip: *;"></a-entity>
                    </a-entity>
                </a-entity>
            </a-entity>

            <!-- SEA -->
            <!-- <a-curvedimage material="shader: standard; side: double; transparent: true; src: assets/sea.png; normalMap:
            assets/seaNormals.tif;" src="assets/sea.png" theta-length="360" theta-start="45" radius="2" rotation="0 0 0"
                position="0 2.5 0" scale="3 15 3" normal-map="#sea-normals" normal-texture-repeat="10 10" roughness="0">
            </a-curvedimage> -->
            <a-cylinder material="shader: standard; side: double; transparent: true; src: assets/sea.png;" normal-map="#sea-normals" normal-scale="1 1" roughness="0" metalness=".6" ; radius="2" rotation="0 0 0" position="0 2.5 0" scale="3 15 3">

            </a-cylinder>
            <!-- LEFT IMAGE -->
            <a-entity rotation="0 0 0" animation="property: position; to: 0 .2 0; loop: true; dir: alternate; easing: easeInOutQuad; dur: 2000">
                <a-image src="assets/left.png" position="-2.230 3.3 -1" scale="1.3 1.3 1" rotation="-10 70 0"></a-image>
            </a-entity>

            <!-- CENTER IMAGE -->
            <a-entity>
                <a-image src="assets/center.png" position="0 -1 -5" scale="1 1 1" rotation="0 0 0"></a-image>
            </a-entity>

            <!-- RIGHT IMAGE -->
            <a-entity rotation="0 0 0">
                <a-image src="assets/right.png" position="2.230 3.3 -1" scale="1.2 1.2 1" rotation="-10 -70 0"></a-image>
                <a-image src="assets/right-2.png" position="2.230 3.3 -1" scale="1.4 1.4 1" rotation="-10 0 0"
                 animation="property: rotation; to: -10 360 -0; loop: true; easing: linear; dur: 10000"></a-image>
            </a-entity>
            <!-- <a-plane color="#202020" side="double" rotation="90 0 0" scale="10 10 10"></a-plane> -->
        </a-scene>
    </div>

    <div class="loading-text">
        <p>CARREGANDO...</p>
        <p class="ready-text">Toque para iniciar</p>
    </div>


    <!-- SCRIPTS -->
    <script src="js/gsap.js"></script>
    <script src="js/index.js"></script>
</body>

</html>